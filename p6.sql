DROP DATABASE IF EXISTS P7;
CREATE DATABASE P7;
USE P7;

CREATE TABLE ppi_call_detail (
       phone_number     DECIMAL(10) NOT NULL,
       call_start       TIMESTAMP,
       call_duration    INTEGER,
       call_description VARCHAR(30),
     PRIMARY KEY (phone_number, call_start)
	)
     PARTITION BY RANGE(UNIX_TIMESTAMP(CALL_START))(
     PARTITION P0 VALUES LESS THAN (UNIX_TIMESTAMP('2023-01-22 00:00:00')),
     PARTITION P1 VALUES LESS THAN (UNIX_TIMESTAMP('2023-01-23 00:00:00'))
     );

INSERT INTO PPI_CALL_DETAIL VALUES
(122434231,'2023-01-20 00:00:00',50,"FDF"),
(122343243,'2023-01-22 10:00:00',40,"FFR");

SELECT * FROM PPI_CALL_DETAIL;

#SELECT DATA FROM PARTITION
SELECT * FROM PPI_CALL_DETAIL PARTITION (P0);
rjprathibha@sjce.ac.in
#DROP A PARTITION
ALTER TABLE PPI_CALL_DETAIL DROP PARTITION P0;